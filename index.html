<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome to Procrustes&#39;s Documentation! &mdash; Procrustes 1.0.0a5 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="usr_doc_installization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> Procrustes
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usr_doc_installization.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Quick_Start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="usr_doc_tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="usr_doc_zref.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/api_index.html">Procrustes API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Procrustes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>Welcome to Procrustes's Documentation!</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="welcome-to-procrustes-s-documentation">
<h1>Welcome to Procrustes's Documentation!<a class="headerlink" href="#welcome-to-procrustes-s-documentation" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://github.com/theochem/procrustes">Procrustes</a> is a free, open-source, and cross-platform
Python library for (generalized) Procrustes problems with the goal of finding the optimal
transformation(s) that makes two matrices as close as possible to each other.
Please use the following citation in any publication using Procrustes library:</p>
<blockquote>
<div><p><strong>&quot;Procrustes: A Python Library to Find Transformations that Maximize the Similarity Between
Matrices&quot;</strong>, F. Meng, M. Richer, A. Tehrani, J. La, T. D. Kim, P. W. Ayers, F. Heidar-Zadeh,
<a class="reference external" href="URL">JOURNAL 2021; ISSUE PAGE NUMBER</a>.</p>
</div></blockquote>
<p>The Procrustes source code is hosted on <a class="reference external" href="https://github.com/theochem/procrustes">GitHub</a> and is
released under the
<a class="reference external" href="https://github.com/theochem/procrustes/blob/master/LICENSE">GNU General Public License v3.0</a>.
We welcome any contributions to the Procrustes library in accordance with our Code of Conduct;
please see our <a class="reference external" href="https://qcdevs.org/guidelines/QCDevsCodeOfConduct/">Contributing Guidelines</a>.
Please report any issues you encounter while using Procrustes library on
<a class="reference external" href="https://github.com/theochem/procrustes/issues">GitHub Issues</a>.
For further information and inquiries please contact us at <a class="reference external" href="mailto:qcdevs&#37;&#52;&#48;gmail&#46;com">qcdevs<span>&#64;</span>gmail<span>&#46;</span>com</a>.</p>
</section>
<section id="description-of-procrustes-methods">
<h1>Description of Procrustes Methods<a class="headerlink" href="#description-of-procrustes-methods" title="Permalink to this headline"></a></h1>
<p>Procrustes problems arise when one wishes to find one or two transformations,
<span class="math notranslate nohighlight">\(\mathbf{T} \in \mathbb{R}^{n \times n}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{S} \in \mathbb{R}^{m \times m}\)</span>,
that make matrix
<span class="math notranslate nohighlight">\(\mathbf{A} \in \mathbb{R}^{m \times n}\)</span> (input matrix) resemble matrix
<span class="math notranslate nohighlight">\(\mathbf{B} \in \mathbb{R}^{m \times n}\)</span> (target or reference matrix) as closely as possible:</p>
<div class="math notranslate nohighlight">
\[\underbrace{\min}_{\mathbf{S}, \mathbf{T}} \|\mathbf{S}\mathbf{A}\mathbf{T} - \mathbf{B}\|_{F}^2\]</div>
<p>where, the <span class="math notranslate nohighlight">\(\| \cdot \|_{F}\)</span> denotes the Frobenius norm defined as,</p>
<div class="math notranslate nohighlight">
\[\| \mathbf{A} \|_{F} = \sqrt{\sum^m_{i=1} \sum^n_{j=1} |a_{ij}|^2}
                     = \sqrt{ \text{Tr} (\mathbf{A}^{\dagger} \mathbf{A})}\]</div>
<p>Here <span class="math notranslate nohighlight">\(a_{ij}\)</span> and <span class="math notranslate nohighlight">\(\text{Tr}(\mathbf{A})\)</span> denote the <span class="math notranslate nohighlight">\(ij\)</span>-th element and trace
of matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, respectively. When <span class="math notranslate nohighlight">\(\mathbf{S}\)</span>
is an identity matrix, this is called a <strong>one-sided Procrustes problem</strong>, and when it is
equal to <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>, this becomes <strong>two-sided Procrustes problem with one transformation</strong>,
otherwise, it is called <strong>two-sided Procrustes problem</strong>. Different Procrustes problems use
different choices for the transformation matrices <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> which
are commonly taken to be orthogonal/unitary matrices, rotation matrices, symmetric matrices, or
permutation matrices. The table below summarizes various Procrustes methods supported:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 7%" />
<col style="width: 5%" />
<col style="width: 60%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Procrustes Type</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{S}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{T}\)</span></p></td>
<td><p>Constraints</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/generic.html#generic"><span class="std std-ref">Generic</span></a>  <a class="bibtex reference internal" href="usr_doc_zref.html#gpa-gower" id="id1">[1]</a></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{I}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{T}\)</span></p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/orthogonal.html#orthogonal"><span class="std std-ref">Orthogonal</span></a> <a class="bibtex reference internal" href="usr_doc_zref.html#opp-1" id="id2">[2]</a><a class="bibtex reference internal" href="usr_doc_zref.html#opp-2" id="id3">[3]</a><a class="bibtex reference internal" href="usr_doc_zref.html#book1-gower2004procrustes" id="id4">[4]</a></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{I}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{Q}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\mathbf{Q}^{-1} = {\mathbf{Q}}^\dagger}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/rotational.html#rotational"><span class="std std-ref">Rotational</span></a> <a class="bibtex reference internal" href="usr_doc_zref.html#book1-gower2004procrustes" id="id5">[4]</a><a class="bibtex reference internal" href="usr_doc_zref.html#rot-brokken1983orthogonal" id="id6">[5]</a><a class="bibtex reference internal" href="usr_doc_zref.html#farrell1966least" id="id7">[6]</a></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{I}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{R}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\begin{cases} \mathbf{R}^{-1} = {\mathbf{R}}^\dagger \\ \left | \mathbf{R} \right | = 1 \\ \end{cases}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/symmetric.html#symmetric"><span class="std std-ref">Symmetric</span></a> <a class="bibtex reference internal" href="usr_doc_zref.html#symmetric-1" id="id8">[7]</a><a class="bibtex reference internal" href="usr_doc_zref.html#escalante1998dykstra" id="id9">[8]</a><a class="bibtex reference internal" href="usr_doc_zref.html#peng2008m" id="id10">[9]</a></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{I}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{X}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{X} = \mathbf{X}^\dagger\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/permutation.html#permutation"><span class="std std-ref">Permutation</span></a> <a class="bibtex reference internal" href="usr_doc_zref.html#zadeh2013molecular" id="id11">[10]</a></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{I}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{P}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\begin{cases} [\mathbf{P}]_{ij} \in \{0, 1\} \\ \sum_{i=1}^n [\mathbf{P}]_{ij} = \sum_{j=1}^n [\mathbf{P}]_{ij} = 1 \\ \end{cases}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/orthogonal.html#orthogonal"><span class="std std-ref">Two-sided Orthogonal</span></a> <a class="bibtex reference internal" href="usr_doc_zref.html#two-sided-ortho-1" id="id12">[11]</a></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{Q}_1^\dagger\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{Q}_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\begin{cases} \mathbf{Q}_1^{-1} = \mathbf{Q}_1^\dagger \\ \mathbf{Q}_2^{-1} = \mathbf{Q}_2^\dagger \\ \end{cases}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/orthogonal.html#orthogonal"><span class="std std-ref">Two-sided Orthogonal with One Transformation</span></a> <a class="bibtex reference internal" href="usr_doc_zref.html#two-sided-ortho-1trans-umeyama" id="id13">[12]</a></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{Q}^{\dagger}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{Q}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{Q}^{-1} = \mathbf{Q}^\dagger\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/permutation.html#permutation"><span class="std std-ref">Two-sided Permutation</span></a> <a class="bibtex reference internal" href="usr_doc_zref.html#two-sided-permutation-1" id="id14">[13]</a></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{P}_1^{\dagger}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{P}_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\begin{cases} [\mathbf{P}_1]_{ij} \in \{0, 1\} \\ [\mathbf{P}_2]_{ij} \in \{0, 1\} \\ \sum_{i=1}^n [\mathbf{P}_1]_{ij} = \sum_{j=1}^n [\mathbf{P}_1]_{ij} = 1 \\ \sum_{i=1}^n [\mathbf{P}_2]_{ij} = \sum_{j=1}^n [\mathbf{P}_2]_{ij} = 1 \\ \end{cases}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/permutation.html#permutation"><span class="std std-ref">Two-sided Permutation with One Transformation</span></a> <a class="bibtex reference internal" href="usr_doc_zref.html#opp-1" id="id15">[2]</a><a class="bibtex reference internal" href="usr_doc_zref.html#ding2008nonnegative" id="id16">[14]</a></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{P}^{\dagger}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathbf{P}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\begin{cases} [\mathbf{P}]_{ij} \in \{0, 1\} \\ \sum_{i=1}^n [\mathbf{P}]_{ij} = \sum_{j=1}^n [\mathbf{P}]_{ij} = 1 \\ \end{cases}\)</span></p></td>
</tr>
</tbody>
</table>
<p>In addition to these Procrustes methods, summarized in the table above, the
<a class="reference internal" href="api/generalized.html#generalized"><span class="std std-ref">generalized Procrustes analysis (GPA)</span></a>
<a class="bibtex reference internal" href="usr_doc_zref.html#stegmann2002brief" id="id17">[15]</a><a class="bibtex reference internal" href="usr_doc_zref.html#gpa-gower" id="id18">[1]</a><a class="bibtex reference internal" href="usr_doc_zref.html#gower1975generalized" id="id19">[16]</a><a class="bibtex reference internal" href="usr_doc_zref.html#ten1977orthogonal" id="id20">[17]</a><a class="bibtex reference internal" href="usr_doc_zref.html#borg2005modern" id="id21">[18]</a> and
softassign algorithm <a class="bibtex reference internal" href="usr_doc_zref.html#kosowsky1994invisible" id="id22">[19]</a><a class="bibtex reference internal" href="usr_doc_zref.html#gold1996softassign" id="id23">[20]</a><a class="bibtex reference internal" href="usr_doc_zref.html#rangarajan1997convergence" id="id24">[21]</a>
are also implemented in our package. The GPA algorithm seeks the optimal transformation matrices
<span class="math notranslate nohighlight">\(\mathbf{T}\)</span> to superpose the given objects (usually more than 2) with minimum distance,</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
  \min \sum_{i&lt;j}^{j} {\left\| \mathbf{A}_i \mathbf{T}_i - \mathbf{A}_j \mathbf{T}_j \right\|_F}^2
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}_i\)</span> and <span class="math notranslate nohighlight">\(\mathbf{A}_j\)</span> are the configurations and <span class="math notranslate nohighlight">\(\mathbf{T}_i\)</span>
and <span class="math notranslate nohighlight">\(\mathbf{T}_j\)</span> denotes the transformation matrices for <span class="math notranslate nohighlight">\(\mathbf{A}_i\)</span> and
<span class="math notranslate nohighlight">\(\mathbf{A}_j\)</span> respectively. When only two objects are given, the problem shrinks to generic
Procrustes.</p>
<p>The <a class="reference internal" href="api/softassign.html#softassign"><span class="std std-ref">softassign</span></a> algorithm was first proposed to deal with quadratic
assignment problem
<a class="bibtex reference internal" href="usr_doc_zref.html#kosowsky1994invisible" id="id25">[19]</a> inspired by statistical physics algorithms and has subsequently been
developed theoretically
<a class="bibtex reference internal" href="usr_doc_zref.html#gold1996softassign" id="id26">[20]</a><a class="bibtex reference internal" href="usr_doc_zref.html#rangarajan1997convergence" id="id27">[21]</a> and extended to many other applications
<a class="bibtex reference internal" href="usr_doc_zref.html#wang2018application" id="id28">[22]</a><a class="bibtex reference internal" href="usr_doc_zref.html#gold1996softassign" id="id29">[20]</a><a class="bibtex reference internal" href="usr_doc_zref.html#gold1996softmax" id="id30">[23]</a><a class="bibtex reference internal" href="usr_doc_zref.html#tian2012convergence" id="id31">[24]</a><a class="bibtex reference internal" href="usr_doc_zref.html#sheikhbahaee2017photometric" id="id32">[25]</a>.
Because the two-sided permutation Procrustes problem is a special case of the
quadratic assignment problem, it can be used here. The objective function is to minimize
<span class="math notranslate nohighlight">\(E_{qap} (\mathbf{M}, \mu, \nu)\)</span>, <a class="bibtex reference internal" href="usr_doc_zref.html#gold1996softassign" id="id33">[20]</a><a class="bibtex reference internal" href="usr_doc_zref.html#yuille1994statistical" id="id34">[26]</a>,
which is defined as follows,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    E_{q a p}(\mathbf{M}, \mu, \nu) = &amp;-\frac{1}{2} \sum_{a i b j} \mathbf{C}_{a i ; b j}
    \mathbf{M}_{a i} \mathbf{M}_{b j} \\
    &amp; + \sum_{a} \mu_{a}\left(\sum_{i} \mathbf{M}_{a i} - 1 \right) + \sum_{i} \nu_{i} \left(
    \sum_{a} \mathbf{M}_{a i} - 1 \right) \\
    &amp; - \frac{\gamma}{2} \sum_{a i} \mathbf{M}_{a i}^{2} + \frac{1}{\beta} \sum_{a i}
    \mathbf{M}_{a i} \log \mathbf{M}_{a i}
\end{aligned}\end{split}\]</div>
<p>Procrustes problems arise when aligning molecules and other objects, when evaluating optimal basis
transformations, when determining optimal mappings between sets, and in many other contexts. This
package includes the options to translate, scale, and zero-pad matrices, so that matrices with
different centers/scaling/sizes can be considered.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usr_doc_installization.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Quick_Start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="usr_doc_tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="usr_doc_zref.html">References</a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/api_index.html">Procrustes API</a></li>
</ul>
</div>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usr_doc_installization.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2022, The QC-Devs Community.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>